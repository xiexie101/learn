---
title: "269 - 《基于 ChatGPT 的 URL 系统》"
date: 2023-03-03
url: https://sorrycc.com/chatgpt-url-system
---

发布于 2023年3月3日

# 269 - 《基于 ChatGPT 的 URL 系统》

1、需求源于我写 MDH 前端周刊，写「深度好文」栏目时需要把每篇文章看一遍，然后写总结和笔记，非常耗时，每周平均 3-4 小时，于是就想着有没有更省力的方法。这不有了 ChatGPT，我试着把内容拿出来，然后加一段 prompt「Please summarize this article in chinese.」，感觉[效果还不错](https://t.me/yqtalk/221)，上周的 MDH 前端周刊部分内容就是由 AI 生成。然后昨天晚上（2023.03.02）有点时间，把这个功能[工具化](https://t.me/yqtalk/234)了。

2、其实我有个更大的想法，是一套基于链接（url）的系统。这是个包含了输入、ChatGPT 总结和输出的自动化流程。输入的链接来自一些输入源，比如 twitter list、hackernews top、我个人的 rss 系统等；ChatGPT 总结就是加 Prompt 然后调 API，包括短评、总结、takeaways 等；输出可以是 Telegram Channel 或 RSS 链接，也可以是基于时间的列表，比如带 summary 的每日好文推荐或者 MDH 前端周刊的其中一个栏目。功能上除了文章，还支持 bilibili、youtube 等视频网站，可能还有游戏、豆瓣、知乎问答等。

3、目前的进展是支持了文章和 [BILIBILI 的总结](https://t.me/yqtalk/237)，代码开源在 [GitHub - sorrycc/url-system](https://github.com/sorrycc/url-system)，感兴趣的可以直接看。clone 下来之后可以通过 `bunx esno src/cli.ts https://path/to/url` 跑来，数据会存在 data 下，以 json 的形式。

4、说下实现（1）。Summrize 的方法就是调 ChatGPT API，我昨天先是用了 transitive-bullshit/chatgpt-api，昨天下午还能跑，到家里就不行了，因为被墙了。而由于 transitive-bullshit/chatgpt-api 的请求库是用 fetch，不支持 proxy，于是我就不依赖他了，改成参考他自己实现了一个简化版的，请求用 axios，支持 https\_proxy 这些环境变量。

5、说下实现（2）。提取文章是基于 Readability。很早之前用过，我都忘记这个库了，也是 ChatGPT 告诉我应该用他的。Readability 会基于文章块的权重做计分，然后算出哪个元素是正文。基本上比较准，但也有些例外，遇到了就需要手动调整规则了。还有要注意的是，ChatGPT 能接收的 token 长度有限，所以要把不必要的内容去掉，比如图片、代码块等不影响文章内容的部分，尤其是代码块，量通常比较大。

6、说下实现（3）。Bilibili 提取字幕参考了 JimmyLv/BiliGPT，作者也在我们星球。他应该是把该趟的坑都趟过了，包括获取字幕的实现我看也是调整了一遍的，现在加 SESSION DATA 之后比较稳了。

7、最后来一些 TODO 吧，如果有同学对此感兴趣，希望参与研发，可以直接联系我，或者直接提 PR。

*   \[x\] 增加命令行，发布 npm 包，让其他同学可以通过 `url-system https://url` 直接用
*   \[ \] 支持 Youtube
*   \[ \] 支持微信公众号
*   \[ \] 支持 Podcast（比如小宇宙），需要先用 whisper 把音频转成文本
*   \[ \] 支持长文（考虑分 chunk 分别总结然后汇总）
*   \[x\] 产品化，通过 [mdhweekly.com/news](http://mdhweekly.com/news) 承载前端类的带总结的「深度好文」
*   \[x\] 服务化，部署到 Replit，提供给大家使用（无需提供 openai token）
