---
title: "342 - 《RSC 笔记》"
date: 2023-09-13
url: https://sorrycc.com/rsc-note
---

发布于 2023年9月13日

# 342 - 《RSC 笔记》

本文为之前阅读 [https://www.joshwcomeau.com/react/server-components/](https://www.joshwcomeau.com/react/server-components/) 做的笔记。

1、RSC 方案省的是 server component 的尺寸，server component 占比越大，效果越明显，反之则不明显或者没啥必要上 RSC。

2、RSC 可以脱离 SSR 单独使用，所以不能说 RSC 是基于 SSR，而是这两个是两块不同的拼图，放在一起，可能会起到相辅相成的效果。

3、如何决定一个组件应该是 server 组件还是 client 组件？1）如果可以成为 server 组件，那他就应该是；2）如果使用了 state 或 effects，通常应该是 client 组件，2）不要盲目追求 server 组件最大化。

4、use client 需要在每个 client 组件里都添加吗？不用！只要在创建 client 组件边界时添加即可，通常是 client 根组件。

5、server 组件不包含在 bundle 里，那客户端渲染时应该怎么拿到相应的 server 组件内容呢？事实上，返回 html 时会额外给一串 server 组件的 jsx 渲染描述（非 html），客户端渲染时直接使用这串描述。

6、ssr 最佳实践应该如何？参考下图。首先是 stream ssr，先 stream 出骨架屏，客户端拿到后就可以去下载 js 和 css 做渲染；同时 server 继续拉数据，数据好了之后渲染额外内容；然后，由于是 rsc，不少组件是 server component，客户端的 js 尺寸得以减少，下载 js 时间得以减少。

![](https://img.alicdn.com/imgextra/i3/O1CN01fveAjy1kXu0hEvCQ2_!!6000000004694-2-tps-1432-850.png)

参考：  
[https://www.joshwcomeau.com/react/server-components/](https://www.joshwcomeau.com/react/server-components/)  
[https://www.patterns.dev/posts/streaming-ssr](https://www.patterns.dev/posts/streaming-ssr)
