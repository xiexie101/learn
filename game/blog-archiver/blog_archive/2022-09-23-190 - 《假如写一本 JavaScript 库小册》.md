---
title: "190 - 《假如写一本 JavaScript 库小册》"
date: 2022-09-23
url: https://sorrycc.com/if-write-a-javascript-library-book
---

发布于 2022年9月23日

# 190 - 《假如写一本 JavaScript 库小册》

昨晚收到[颜海镜](https://github.com/yanhaijing)老师尚未出版的《现代 JavaScript 库开发》，快速翻了一遍，第一个冒出的想法是，如果我来组织关于这个主题的小册，会如何写。

先说下这本书。

1、还是第一次看有人写这个领域的书，角度不错，找了一个书籍类知识体系的缺口，应该不少同学都有这部分的需求。

2、在我之前的理解里，关于 JavaScript 库开发可能没那么多内容可以写。书中「2、构建」「4、开源」「5、维护」是 JavaScript 库独有的知识，「3、测试」「6、设计」「7、安全」「8、抽象」更多是通用知识，开发库和项目都适用，「9-11」是不同库类型的实践。

3、书的内容适用于初中级开发者，知识点基本还是站在社区前沿的。熟悉 JavaScript 库开发的也可以查漏补缺，比如其中「7、安全」正好补了我个人的知识点空缺。

再看如果我来写这个主题的小册，会如何写？

基本思路是这样。1）知识最小集，不给不需要的和过时的，比如 AMD、lerna 等，2）知识最前沿，选最前的方案，但同时给备选方案，3）注重实践，实践不仅能用户更容易上手，还能填充小册内容。

以下是大纲，也可以当做这个领域的知识图谱。

1、快速上手

1.1 JavaScript 库和项目有什么异同？  
1.2 10 分钟极简 JavaScript 库开发（npm init、touch index.js、npm version、npm publish、git push，适用于什么场景？缺了什么？怎么做更好？逐步展开）

2、基础知识

2.1 模块化（CJS、ESM、UMD、Pure ESM、package.json exports）  
2.2 package.json（常用 key 和 dependencies 相关）  
2.3 npm scripts  
2.4 包管理工具（npm、yarn、pnpm、cnpm 的 cli 和 registry）  
2.5 Sematic Version

3、2022 年应该这么开发 JavaScript 库

3.1 初始化（选个好包名、选择开源协议、选用 pnpm、关联 github 仓库）  
3.2 使用 TypeScript 开发（渐进式、工具链调整、tsconfig.json、dts 文件输出）  
3.3 协作（prettier、husky、lint-staged、eslint）  
3.4 构建（tsc、tsup、father，选择输出格式）  
3.5 开发（构建 + watch、sourcemap、dts sourcemap）  
3.6 测试（vitest）  
3.7 Changelog（github release、changeset）  
3.8 文档（如何写好 README）  
3.9 脚本（zx、esno）  
3.10 发布（自定义发布流程）  
3.11 维护（dist-tag、回滚、数据统计）

4、JavaScript 库构建

4.1 Bundle 和 Bundless  
TODO

5、JavaScript 库实践

5.1 手写命令行工具库（常用命令行相关库、测试）  
5.2 手写组件库（产物语法补丁、@babel/runtime、不同的测试方案、依赖 antd 的组件如何开发）  
5.3 手写插件类 JavaScript 库（peerDependencies、测试）

6、JavaScript 库进阶

6.1 JavaScript 库与 Monorepo  
6.2 JavaScript 库与补丁  
6.3 JavaScript 库与安全  
6.4 JavaScript 库与样式（CSS Modules 不合适、按需加载）  
6.5 JavaScript 库与 Tree-Shaking  
6.6 使用 Github CI 提升项目稳定性  
6.7 使用 father 框架简化 JavaScript 库研发  
6.8 使用 patch-package 修复依赖包的问题  
6.9 使用依赖预编译来彻底锁定依赖  
6.10 开源社区的运营和维护

拍脑袋想的，你觉得还缺啥？

参考：  
[https://t.zsxq.com/06uVvZnur](https://t.zsxq.com/06uVvZnur)  
[75 - 《一份新大纲：「极简框架课：手写 Umi」》](https://sorrycc.com/framework-course) [141 - 《手撕源码15：father 4》](https://sorrycc.com/source-15-father-4) [https://modernjs.dev/docs/start/library](https://modernjs.dev/docs/start/library)  
[https://yuque.antfin.com/bigfish/dumi/ab3gxu](https://yuque.antfin.com/bigfish/dumi/ab3gxu)
