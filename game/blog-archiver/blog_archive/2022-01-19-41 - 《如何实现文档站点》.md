---
title: "41 - 《如何实现文档站点》"
date: 2022-01-19
url: https://sorrycc.com/how-to-implement-document-site
---

发布于 2022年1月19日

# 41 - 《如何实现文档站点》

最近在做 umi@4 的收尾，而 dumi 暂不支持 umi@4，如果用 umi@3 做 umi@4 的文档感觉比较怪，所以今天整理完 umi@4 的文档结构之后，转头写了个基于 umi 4 的文档站点 rfc，也可以理解为 lite dumi。只包含文档功能，不支持组件。

之前 dumi 由 Peach 老师操刀，我还没看过实现。今天简单过了一遍社区的竞品，包括 vitepress、vuepress、docusaurus 和 nextra，觉得整体实现步骤包括：

1、文件路由。docs 目录下的 md 或 mdx 文件即路由。  
2、解析器。能解析 md 和 mdx 文件，通常转化为 react 组件。解析工具两大派，remark 和 markdown-it，前者基于 unifiedjs 扩展性更好一些，再加上 @mdx-js/mdx 做 mdx 的解析，gray-matter 做头部信息的解析，prism 和 prism-react-renderer 做语法高亮，等等。  
3、主题式设计。通过 theme 的设计，不仅支持文档站，还可以支持 blog、landing page、resume 等。时间原因，第一步先做 doc 主题，组件可以拆分为 Home、Head、Search、NavBar、Logo、Sidebar、Toc、Tip、Bleed、LangSwitch、ThemeSwitch 等。

然后，看下实现之后 umi 用户如何使用，

1、pnpm i @umijs/plugin-docs  
2、配置里加上 docs 配置，比如 `docs: { theme: 'doc', themeConfig: { menu: ['docs', 'blog', { name: 'Github', href: '' }] } }`  
3、新建 docs 目录，并在此写文档  
4、done

最后，整理完 RFC 之后，发现这是个通用的方案。可能作为 dumi 下个版本的原型，把组件研发也作为一个 theme 开发；也可能是 dumi 一个子方向，比如 dumi-docs 做纯粹文档型站点的探索。

竞品：

[https://vuepress.vuejs.org/](https://vuepress.vuejs.org/)  
[https://vitepress.vuejs.org/](https://vitepress.vuejs.org/)  
[https://github.com/facebook/docusaurus](https://github.com/facebook/docusaurus)  
[https://github.com/shuding/nextra/tree/core](https://github.com/shuding/nextra/tree/core)

依赖：

[https://github.com/kentcdodds/mdx-bundler](https://github.com/kentcdodds/mdx-bundler)  
[https://github.com/sw-yx/swyxkit](https://github.com/sw-yx/swyxkit)  
[https://github.com/mdx-js/mdx](https://github.com/mdx-js/mdx)  
[https://github.com/remarkjs/remark](https://github.com/remarkjs/remark)  
[https://github.com/hashicorp/next-mdx-remote](https://github.com/hashicorp/next-mdx-remote)  
[https://github.com/unifiedjs](https://github.com/unifiedjs)  
[https://github.com/markdown-it/markdown-it](https://github.com/markdown-it/markdown-it)
