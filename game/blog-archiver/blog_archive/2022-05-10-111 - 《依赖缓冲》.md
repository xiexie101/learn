---
title: "111 - 《依赖缓冲》"
date: 2022-05-10
url: https://sorrycc.com/dependency-buffer
---

发布于 2022年5月10日

# 111 - 《依赖缓冲》

大家执行 npm info antd 会得到下面的结果。

```
dist-tags:  
alpha: 3.0.0-alpha.3 conch: 4.20.1     latest: 4.20.3    previous: 3.26.20  
beta: 3.0.0-alpha0  latest-2: 2.13.14   next: 4.20.0-alpha.1
```

如果仔细看，会发现有个 conch tag，这个 tag 始终会和 latest 版本差几个版本号。这就是缓冲版本，conch 即贝壳的取名也是有寓意的，即沙滩上给海浪的一个缓冲。蚂蚁内部会使用 conch 版本，在框架层做约束，从而避免内部项目直面 latest 的 bug。

但通常引入一个设计，都会引发一些其他的问题。这个方案的问题是，项目中使用 antd 不仅是 import antd，还可能 import 基于 antd 二次封装的库，比如 pro 组件等。此时，如果 pro 组件使用了 latest 版本的功能，则可能会导致项目出错。这是真实发生的问题。

本文仅提供一个思路，更完善的方案一直在路上。
