---
title: "504 - 《TNF 开发笔记 13：精修 create-tnf》"
date: 2024-12-30
url: https://sorrycc.com/tnf-13
---

发布于 2024年12月30日

# 504 - 《TNF 开发笔记 13：精修 create-tnf》

1、之前有找群里的朋友[改过一版](https://github.com/umijs/tnf/pull/57)，感谢，但毕竟和自己的想法会有些差异，create-xxx 又时大家接触一个新框架的第一道门，想着得再装点一下。于是又花时间[精修了下](https://github.com/umijs/tnf/pull/82)，舒服了。

![](https://tcc.sorrycc.com/p/4ed92358-330d-4933-a424-2891a32875f2.gif)

2、修改主要围绕两个点，1）交互界面，要好看，2）尺寸，安装要快。

3、交互界面。

之前就用的 @clack/prompt，create-umi 也用的这个，但总觉得用下来差那么点意思，直到看到 svelte-cli 的使用，感觉对味了。顺着代码找了下，发现 svelte-cli 是 [fork 了一份到自己仓库](https://github.com/sveltejs/cli/tree/main/packages/clack-prompts)，同时加了 box 和 task 的能力。

于是我决定用 svelte-cli 的版本。1）先是 copy 到 create-tnf 的仓库里，2）由于 clack 的依赖有 esm only 的包，就把 create-tnf 改成了 type: module 的格式（后面 create-tnf 改用打包的方式之后，其实是不是 esm only 就无所谓了）3）由于 clack tnf 和其他场景也会用到，于是把这个版本[独立成仓库](https://github.com/sorrycc/clack)来发布。

![](https://tcc.sorrycc.com/p/a0502758-daa7-4cc5-a3ae-f44c4febf9c9.png)

4、尺寸。

减少尺寸最好的方式就是打包，把所有依赖和自己全部打包到一起，再压个缩，不要太小。

![](https://tcc.sorrycc.com/p/23ea2c47-ac54-4380-ab81-148f8d492f50.png)

create-tnf 的打包用的 Mako。有遇到 dirname 的问题，给 mako 提了 [issue](https://github.com/umijs/mako/issues/1734)，应该没那么快改好，先[手动 patch](https://github.com/umijs/tnf/blob/7b4640c/scripts/buildCreateTnf.ts#L29-L38) 绕过了。

5、其他。

1）调整了模版，名字从 simple 改成 Minimal，更正式一些，同时加了 .gitignore 等文件。

2）npmClient 支持用户选择，我试过 bun 也能安装 tnf 的项目，于是也加上了。
