---
title: "130 - 《手写了一个翻译脚本：一》"
date: 2022-06-08
url: https://sorrycc.com/how-to-write-translate-script-01
---

发布于 2022年6月8日

# 130 - 《手写了一个翻译脚本：一》

今天写了个简单的翻译脚本满足个人需要，见图 1，将左边的英文文章翻译成右边的中英文章，翻译接口基于 Deepl，质量有保障。下面将告诉你是如何实现的，如果你也有需要，可以自行尝试。

![](https://img.alicdn.com/imgextra/i4/O1CN01peSRMn1e0ZXKvUhfm_!!6000000003809-0-tps-3348-1854.jpg)

1、先要有 Deepl 的翻译接口。之前在 [https://t.zsxq.com/02jIurnIM](https://t.zsxq.com/02jIurnIM) 的第一点里有提，基于 [https://hub.docker.com/r/zu1k/deepl](https://hub.docker.com/r/zu1k/deepl) 部署一个 docker 服务，就能使用 Deepl 的 API。

2、主要实现代码见 [https://gist.github.com/sorrycc/444a368b3382d097e6c5ab08ad47b5c9](https://gist.github.com/sorrycc/444a368b3382d097e6c5ab08ad47b5c9) 。由于我是用 script 的方式编写，所以基于 zx + esno。

3、网页转 markdown 目前是手动的，用的 [https://euangoddard.github.io/clipboard2markdown/，copy](https://euangoddard.github.io/clipboard2markdown/%EF%BC%8Ccopy) 后在这里粘贴，然后拿到 markdown 内容保存到本地文件。

4、运行效果如下。

```bash
$ ms translate docs/test.md
info - { _: [ 'docs/test.md' ] }
info - text length: 192
event - Translated to docs/test.translated.md
```

实现上的一些注意点，

1、要处理文本长度，如果超过 5000 个字符，需要拆分翻译然后合并（目前我偷懒直接抛错处理）  
2、代码块不应该翻译（目前我偷懒直接不处理翻译结果中的代码块）  
3、翻译接口要加缓存，提升 debug 效率
