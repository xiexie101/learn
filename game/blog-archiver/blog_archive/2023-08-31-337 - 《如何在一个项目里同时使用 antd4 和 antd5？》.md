---
title: "337 - 《如何在一个项目里同时使用 antd4 和 antd5？》"
date: 2023-08-31
url: https://sorrycc.com/multiple-antd-versions
---

发布于 2023年8月31日

# 337 - 《如何在一个项目里同时使用 antd4 和 antd5？》

源于上午周会的讨论。也是现实业务中发生的事情。

为什么会有这样奇葩的需求？

目前来看，antd 4 到 5 会是个长期的过程。由于是基于 antd 有大量二次封装的组件库，这些组件库的升级也没有那么快。比如有个二次封装的依赖依赖了 antd 5，而项目里用的是 antd 4。又或者反一下。

混用一个库的两个大版本肯定会存在问题，比如组件设计规范的不一致，多实例的互通等。但架不住现实中业务就是有这样的需求。

所以怎么解？

上午大家讨论了一些方案。

比如。不混用。升级项目和组件库的 antd 依赖到 antd 5。这是期望的方式，但对于某些业务和依赖来说，并不现实，比如项目太大无法一次修改完成。

比如。探究背后的需求，如果需求是为了统一用 antd 5 的设计，那把 antd 5 的schema 转成 less 变量，然后套给 antd 4 用，可能也不失为一种快速可用的方法。

比如。让组件库显式声明 antd 依赖。一个明显的缺点是，1）在依赖包匹配时（比如两个 antd 4）可能造成产物重复，2）同时要注意的是组件库不受控，维护者可能不愿意修改。

比如。通过 npm alias 指定 antd 为 antd-4，然后修改项目 import antd 为 import antd-4。

```json
"dependencies": {  
  "antd-4": "npm:antd@^4",  
  "antd": "5"  
}
```

结论是，最后一种方式虽然对代码的修改量较大，但相对来说属于坑更少的方式。
