---
title: "357 - 《我看微前端》"
date: 2023-10-24
url: https://sorrycc.com/micro-f2e-feeling
---

发布于 2023年10月24日

# 357 - 《我看微前端》

> 以下纯粹是个人从框架角度看问题的想法和吐槽，不全面。微前端从业务角度看，肯定是有其特有的价值的。

1、我们通常会为了解问题 A 产出方案 B，同时由方案 B 带出问题 C 和 D。然后我们再花精力解问题 C 和 D。聪明的同学们此时会权衡问题 A 和问题 C + D，同时考虑问题 A 是否有其他解。如果放弃 A，A 就成了技术债；如果继续解问题 C + D，可能成功，也可能会引出问题 E、F、G。这是程序员的生命周期，高级程序员相比初级程序员的价值在于能更早地看到问题 C 和 D，从而更早地做出决策，减少试错成本。

2、不过蚂蚁中台的微前端我觉得用地有点过。过的原因是他已成为全部中台应用的基础设施，所有项目都是微前端。当然，这有好处，没好处也不会上，任何方案都是为了解问题而存在的。但也不可否认地带来了很多额外问题，然后我们需要花很多精力去解这些额外问题。

3、微前端带来了哪些额外问题？

1）性能变差。比如一些应用在迁到蚂蚁之前 1s 内完成加载的，现在要 6 - 7s。因为现在是「基座 + 主应用 + 子应用」的结构。虽说内网网速快+内网项目不用太在意性能，但也架不住三层串行加载 + JavaScript 代码执行，以及由此带来的重复代码和依赖。同时，由于加了这套架构，很多之前能做的优化不能做或者收效甚微，比如 SSR 不能做，比如子应用本身的请求 preload 收效甚微。

2）问题复杂化。很多问题本身并不复杂，比如数据通讯、页面加载、埋点、国际化，社区已有最佳实践。而一旦加上微前端，有了父子应用，就变得复杂。比如主子应用的依赖复用问题、主子应用的通讯问题、子应用重复挂载（先卸载再挂载）导致的问题，沙箱相关的调试和异常 JavaScript 执行问题，埋点如何避免主子应用或子子应用串掉的问题，等等。此外，还有由此带来的日常研发成本和答疑成本。

3）技术耦合和门槛。举几个遇到过的具体场景，以 qiankun 为例。1）一旦上了微前端，再想要 SSR 或 RSC 就很困难了。在我看来，React 社区，未来应是 RSC 的。但这和微前端是冲突的。2）之前想上 Bundless ESM 方案的时候，微前端也是卡点，他不支持。3）记得 styled-components 的极速模式微前端也是不支持的。

4）研发体验降低。比如需要调试得依赖 Chrome 插件问题，元信息得有个在线平台进行管理等等。没具体开发过，只是听闻。

4、微前端应是最后的选择，而不是默认配置。按我理解，现在微前端可以解三板斧、融合 Pro Code 和 Low Code、统一导航头、应用拆分部署、支持多框架多版本混用、统一 Runtime 的收益等等。这些问题微前端是否是唯一解和最佳解？是否大部分项目都有此问题？比如统一导航头是否有其他解，当初在淘宝通过 JavaScript + MPA 解其实也很稳；比如三板斧是否所有项目都需要三板且必须通过前端容器来解？微前端架构的项目访问久了，还是挺想念传统前端项目的。

参考：  
[https://www.breck-mckye.com/blog/2023/05/Microfrontends-should-be-your-last-resort/](https://www.breck-mckye.com/blog/2023/05/Microfrontends-should-be-your-last-resort/)
