---
title: "556 - 《小册大纲：Code Agent 从入门到精通》"
date: 2025-04-25
url: https://sorrycc.com/code-agent-from-zero-to-master
---

发布于 2025年4月25日

# 556 - 《小册大纲：Code Agent 从入门到精通》

> 之前整理的大纲没有一本写完的，希望这一本能写完吧。

1、感觉我想写的东西实在太多了，我的 To Write 列表已经堆得不成样子了，精力实在是有限，又要写公司的工具，又要开会，以及一些琐碎的事情，周末还要出去玩，一个都不能落下。。

2、但是最近又想写一本小册了，名字叫《Code Agent 从入门到精通》。因为手上的工作就是关于这个的。所以想把调研得到和工作中的经验通过小册的形式更系统地分享给大家。课程的内容是教大家如何从零开始写一个 Code Agent，不用任何框架。然后慢慢深入，把各个维度需要考虑的点逐步做下拆解。这里面，由于模型的差异、上下文窗口尺寸的限制，以及对于体验的追求、对需求的理解和工程化的各个方面，很多点我觉得都还是挺有意思的。最后，再结合一些在蚂蚁应用的最佳实践。

3、昨晚整理了下 Takumi 的 [Roadmap](https://cdn.jsdelivr.net/gh/sorrycc-bot/image-2025-04@main/uPic/oIWHbu.png)，发现 Code Agent 要做深入的，还是有很多可以深入的点。他并不像一开始我觉得的那么简单，不仅仅是一个大模型加 prompt 加 tools 就完了。这么多的 Code Agent，都是相同的大模型 Claude 3.7 Sonnet，为什么 Cursor 一枝独秀？ 所以，一个 agents 好不好用，关键还是在于你对于细节的打磨到什么程度。

4、这本小册面向的用户是「有一定编程基础，对 AI 感兴趣的开发者，希望构建自己 Agent 的工程师」，相比市面上其他的资料的优点是「基于实践而不是理论」。

5、我先整理下大纲。

*   基础入门
    *   白话 AI 基础概念（LLMs、Prompt Engineering 基础、Tokens、Embeddings、Function Calling/Tool Use 等）
    *   我对于 Code Agent 的理解（是什么、能做什么、构成）
    *   Code Agent 对比（GitHub Copilot、Cursor、Aider、CodeX、Claude Code 等）
    *   Code Agent 框架对比
    *   为什么不用 Code Agent 框架
*   构建第一个 Code Agent
    *   构建第一个 Code Agent（LLMs + Prompt）
        *   BONUS：模型和提供商
        *   BONUS：模型别名
        *   BONUS：边界场景和错误处理
        *   BONUS：npm 项目的工程化
    *   集成第一个工具：Bash（LLMs + Prompt + Tools）
        *   BONUS：Function Call 的两种实现（结构化）
        *   BONUS：Bash Tool 的安全性（Whitelist、Docker、Seatbelt 等）
        *   BONUS：系统提示词的设计
        *   场景应用：语义化执行脚本
    *   集成第二个工具：文件读写（FileEdit、FileRead、FileWrite）
        *   BONUS：FileEdit 的三种实现
        *   场景应用：语义化执行脚本
    *   选修：集成第三个工具：文件检索（Glob、Grep、Ls）
        *   BONUS：文件检索的多种实现
    *   补充上下文：让 LLMs 理解你的项目
        *   BONUS：实现 init 命令（不用每次都理解一遍）
        *   BONUS：rules 文件
    *   最简 MCP 支持：stdio 协议
        *   BONUS：支持 sse 协议
        *   BONUS：MCP 的权限认证
        *   BONUS：MCP 的 What、Why 和 How
        *   BONUS：MCP Server 实现的最佳实践
        *   场景应用：用高德地图 MCP 规划下周末的杭州 2 日游（考虑替换为更贴近编程的场景）
*   Code Agent 进阶
    *   支持 Prompt 里使用 @ 引用文件
        *   BONUS：支持目录、codebase、git diff 等
    *   提取 MessageHistory 做上下文管理
    *   用 Plan 模式做任务拆解和架构设计
        *   BONUS：两种 Plan 模式（架构、Todolist）
        *   BONUS：为什么 Plan 和 Editor 应选用不同的模型
    *   Git 集成方案
    *   支持 ReAct 模式（Reason + Act 框架）
    *   上下文长度限制及其应对策略
    *   Tool Use 的 Approve 策略
    *   仓库理解的多种策略（Repomix、Treesit 等）
    *   通过 RAG 引入外部知识库
    *   通过 watch 模式让 Agent 更好地与 IDE 集成
    *   更多上下文和 Tools（IDE 插件、Native 应用、浏览器插件等）
    *   安全安全安全！（ignore 文件、approve 策略、沙箱等）
    *   BONUS：插件体系，让你的 Agent 可被扩展
    *   BONUS：SESSION LOG，让你的 Agent 可回放
    *   BONUS：用 React 实现 Cli、Browser 和 Extension 的跨端逻辑
    *   BONUS：语音输入
*   Code Agent 高级
    *   设计一套简单的 Agent 评估方案
        *   BONUS：Agent 评估，如何衡量一个 Agent 的“好坏”
    *   多 Agent 协作：任务分解与协同工作
    *   Tree of Thoughts
    *   利用 Prompt Cache & Reponsive API 提速和节约成本
    *   利用无限输出绕过模型限制生成长回复
*   个人经验
*   附录
    *   常用 LLM API 和 SDK 参考
    *   推荐工具库
    *   术语表
    *   参考文献和进阶阅读资料
    *   本书示例代码库链接

参考：  
[473 - 《小册大纲：P8 大厂前端的日常》](https://sorrycc.com/pfd-outline)
